Option Explicit

Sub Add_Worker()
    Dim Password
    Password = "Ej20082018*Excel"
    Worksheets("TOT").Unprotect Password:=Password
    Worksheets("FORMAZIONE").Unprotect Password:=Password
    Dim WorkerName As String
    Dim WorkerName_Surname As String
    Dim Contract As String
    Dim LastRow As Integer
    Dim Confirmation As VbMsgBoxResult
    Dim Answer As String
    Dim LastRowType As Integer
    Dim SelectedOption As String
    
    LoginForm.Show
    If Worksheets("Tabelle").Range("H3").Value = 0 Then Exit Sub
    
    Confirmation = MsgBox("Sei sicuro di voler inserire un dipendente?", vbYesNo + vbDefaultButton2 + vbQuestion, "Conferma Eliminazione")
    If Confirmation = vbNo Then Exit Sub ' L'utente ha annullato
    
    ' Trova l'ultima riga disponibile nel foglio di lavoro (presumendo che i dati siano nella colonna A)
    LastRow = 4
    While Cells(LastRow, 1) <> ""
        LastRow = LastRow + 1
    Wend
    LastRow = LastRow - 4
    Worksheets("TOT").Rows(LastRow).Insert
    DoEvents ' Permette a Excel di aggiornarsi
    Worksheets("FORMAZIONE").Activate
    Worksheets("FORMAZIONE").Rows(LastRow).Insert
    DoEvents ' Permette a Excel di aggiornarsi
    Worksheets("TOT").Activate
    Worksheets("TOT").Rows(LastRow - 1).Copy
    Worksheets("TOT").Rows(LastRow).PasteSpecial xlPasteAll
    DoEvents ' Permette a Excel di aggiornarsi
    Worksheets("FORMAZIONE").Activate
    Worksheets("FORMAZIONE").Rows(LastRow - 1).Copy
    Worksheets("FORMAZIONE").Rows(LastRow).PasteSpecial xlPasteAll
    Worksheets("TOT").Activate
    DoEvents ' Permette a Excel di aggiornarsi
    
    Worksheets("TOT").Cells(LastRow, 1).Value = Cells(LastRow - 1, 1).Value + 1
    Worksheets("FORMAZIONE").Activate
    Worksheets("FORMAZIONE").Cells(LastRow, 1).Value = Cells(LastRow - 1, 1).Value + 1
    Worksheets("TOT").Activate
    DoEvents ' Permette a Excel di aggiornarsi
    
    Answer = InputBox("Inserisci il nuovo nome per il nuovo dipendente :")
        Worksheets("TOT").Cells(LastRow, 2).Value = Answer
        Worksheets("TOT").Cells(LastRow, 26).Value = Answer
        Worksheets("TOT").Cells(LastRow, 33).Value = Answer
        DoEvents ' Permette a Excel di aggiornarsi
    
    Answer = InputBox("Inserisci il nuovo nome e cognome per il nuovo dipendente :")
        Worksheets("TOT").Cells(LastRow, 3).Value = Answer
        Worksheets("TOT").Cells(LastRow, 34).Value = Answer
        Worksheets("TOT").Cells(LastRow, 53).Value = Answer
        Worksheets("FORMAZIONE").Activate
        Worksheets("FORMAZIONE").Cells(LastRow, 2).Value = Answer
        Worksheets("FORMAZIONE").Cells(LastRow, 19).Value = Answer
        Worksheets("TOT").Activate
        DoEvents ' Permette a Excel di aggiornarsi
        
    Answer = InputBox("Inserisci il contratto per il nuovo dipendente :")
        Worksheets("TOT").Cells(LastRow, 27).Value = Answer
    
    With Worksheets("TOT")
        .Range(.Cells(LastRow, 35), .Cells(LastRow, 50)).Value = ""
    End With
    
    Worksheets("FORMAZIONE").Activate
    
    With Worksheets("FORMAZIONE")
        .Range(.Cells(LastRow, 3), .Cells(LastRow, 16)).Value = ""
        .Range(.Cells(LastRow, 20), .Cells(LastRow, 55)).Value = ""
    End With
    
    Worksheets("TOT").Activate
    
    Confirmation = MsgBox("Vuoi cambiargli il ruolo da cucina?", vbYesNo + vbDefaultButton2 + vbQuestion, "Conferma Eliminazione")
    If Confirmation = vbNo Then Exit Sub ' L'utente ha annullato
    
    SelectedOption = Change_Type.GetSelectedOption()
        If SelectedOption = "" Then Exit Sub ' L'utente ha annullato
        
        LastRowType = 4
        
        If SelectedOption = "Gel" Then
            While Cells(LastRowType, 2).Interior.Color <> RGB(255, 255, 255)
                LastRowType = LastRowType + 1
            Wend
            Worksheets("TOT").Rows(LastRowType).Insert
            DoEvents ' Permette a Excel di aggiornarsi
            Worksheets("FORMAZIONE").Activate
            Worksheets("FORMAZIONE").Rows(LastRowType).Insert
            DoEvents ' Permette a Excel di aggiornarsi
            Worksheets("TOT").Activate
            Worksheets("TOT").Rows(LastRowType - 1).Copy
            Worksheets("TOT").Rows(LastRowType).PasteSpecial xlPasteAll
            DoEvents ' Permette a Excel di aggiornarsi
            Worksheets("FORMAZIONE").Activate
            Worksheets("FORMAZIONE").Rows(LastRowType - 1).Copy
            Worksheets("FORMAZIONE").Rows(LastRowType).PasteSpecial xlPasteAll
            Worksheets("TOT").Activate
            DoEvents ' Permette a Excel di aggiornarsi
            If LastRow >= LastRowType Then
                LastRow = LastRow + 1
            End If
            Worksheets("TOT").Cells(LastRowType, 2).Value = Worksheets("TOT").Cells(LastRow, 2).Value
            Worksheets("TOT").Cells(LastRowType, 26).Value = Worksheets("TOT").Cells(LastRow, 26).Value
            Worksheets("TOT").Cells(LastRowType, 33).Value = Worksheets("TOT").Cells(LastRow, 33).Value
            Worksheets("TOT").Cells(LastRowType, 3).Value = Worksheets("TOT").Cells(LastRow, 3).Value
            Worksheets("TOT").Cells(LastRowType, 34).Value = Worksheets("TOT").Cells(LastRow, 34).Value
            Worksheets("TOT").Cells(LastRowType, 53).Value = Worksheets("TOT").Cells(LastRow, 53).Value
            Worksheets("TOT").Cells(LastRowType, 27).Value = Worksheets("TOT").Cells(LastRow, 27).Value
            Worksheets("FORMAZIONE").Cells(LastRowType, 2).Value = Worksheets("FORMAZIONE").Cells(LastRow, 2).Value
            Worksheets("FORMAZIONE").Cells(LastRowType, 19).Value = Worksheets("FORMAZIONE").Cells(LastRow, 19).Value
        ElseIf SelectedOption = "Front" Then
            While Cells(LastRowType, 2).Interior.Color <> RGB(221, 235, 247)
                LastRowType = LastRowType + 1
            Wend
            Worksheets("TOT").Rows(LastRowType).Insert
            DoEvents ' Permette a Excel di aggiornarsi
            Worksheets("FORMAZIONE").Activate
            Worksheets("FORMAZIONE").Rows(LastRowType).Insert
            DoEvents ' Permette a Excel di aggiornarsi
            Worksheets("TOT").Activate
            Worksheets("TOT").Rows(LastRowType - 1).Copy
            Worksheets("TOT").Rows(LastRowType).PasteSpecial xlPasteAll
            DoEvents ' Permette a Excel di aggiornarsi
            Worksheets("FORMAZIONE").Activate
            Worksheets("FORMAZIONE").Rows(LastRowType - 1).Copy
            Worksheets("FORMAZIONE").Rows(LastRowType).PasteSpecial xlPasteAll
            Worksheets("TOT").Activate
            DoEvents ' Permette a Excel di aggiornarsi
            If LastRow >= LastRowType Then
                LastRow = LastRow + 1
            End If
            Worksheets("TOT").Cells(LastRowType, 2).Value = Worksheets("TOT").Cells(LastRow, 2).Value
            Worksheets("TOT").Cells(LastRowType, 26).Value = Worksheets("TOT").Cells(LastRow, 26).Value
            Worksheets("TOT").Cells(LastRowType, 33).Value = Worksheets("TOT").Cells(LastRow, 33).Value
            Worksheets("TOT").Cells(LastRowType, 3).Value = Worksheets("TOT").Cells(LastRow, 3).Value
            Worksheets("TOT").Cells(LastRowType, 34).Value = Worksheets("TOT").Cells(LastRow, 34).Value
            Worksheets("TOT").Cells(LastRowType, 53).Value = Worksheets("TOT").Cells(LastRow, 53).Value
            Worksheets("TOT").Cells(LastRowType, 27).Value = Worksheets("TOT").Cells(LastRow, 27).Value
            Worksheets("FORMAZIONE").Cells(LastRowType, 2).Value = Worksheets("FORMAZIONE").Cells(LastRow, 2).Value
            Worksheets("FORMAZIONE").Cells(LastRowType, 19).Value = Worksheets("FORMAZIONE").Cells(LastRow, 19).Value
        ElseIf SelectedOption = "Tutto" Then
            While Cells(LastRowType, 2).Interior.Color <> RGB(252, 228, 214)
                LastRowType = LastRowType + 1
            Wend
            Worksheets("TOT").Rows(LastRowType).Insert
            DoEvents ' Permette a Excel di aggiornarsi
            Worksheets("FORMAZIONE").Activate
            Worksheets("FORMAZIONE").Rows(LastRowType).Insert
            DoEvents ' Permette a Excel di aggiornarsi
            Worksheets("TOT").Activate
            Worksheets("TOT").Rows(LastRowType - 1).Copy
            Worksheets("TOT").Rows(LastRowType).PasteSpecial xlPasteAll
            DoEvents ' Permette a Excel di aggiornarsi
            Worksheets("FORMAZIONE").Activate
            Worksheets("FORMAZIONE").Rows(LastRowType - 1).Copy
            Worksheets("FORMAZIONE").Rows(LastRowType).PasteSpecial xlPasteAll
            Worksheets("TOT").Activate
            DoEvents ' Permette a Excel di aggiornarsi
            If LastRow >= LastRowType Then
                LastRow = LastRow + 1
            End If
            Worksheets("TOT").Cells(LastRowType, 2).Value = Worksheets("TOT").Cells(LastRow, 2).Value
            Worksheets("TOT").Cells(LastRowType, 26).Value = Worksheets("TOT").Cells(LastRow, 26).Value
            Worksheets("TOT").Cells(LastRowType, 33).Value = Worksheets("TOT").Cells(LastRow, 33).Value
            Worksheets("TOT").Cells(LastRowType, 3).Value = Worksheets("TOT").Cells(LastRow, 3).Value
            Worksheets("TOT").Cells(LastRowType, 34).Value = Worksheets("TOT").Cells(LastRow, 34).Value
            Worksheets("TOT").Cells(LastRowType, 53).Value = Worksheets("TOT").Cells(LastRow, 53).Value
            Worksheets("TOT").Cells(LastRowType, 27).Value = Worksheets("TOT").Cells(LastRow, 27).Value
            Worksheets("FORMAZIONE").Cells(LastRowType, 2).Value = Worksheets("FORMAZIONE").Cells(LastRow, 2).Value
            Worksheets("FORMAZIONE").Cells(LastRowType, 19).Value = Worksheets("FORMAZIONE").Cells(LastRow, 19).Value
        ElseIf SelectedOption = "Cucina" Then
            LastRowType = 5
            While Cells(LastRowType, 1) <> "1"
                LastRowType = LastRowType + 1
            Wend
            Worksheets("TOT").Rows(LastRowType).Insert
            DoEvents ' Permette a Excel di aggiornarsi
            Worksheets("FORMAZIONE").Activate
            Worksheets("FORMAZIONE").Rows(LastRowType).Insert
            DoEvents ' Permette a Excel di aggiornarsi
            Worksheets("TOT").Activate
            Worksheets("TOT").Rows(LastRowType - 1).Copy
            Worksheets("TOT").Rows(LastRowType).PasteSpecial xlPasteAll
            DoEvents ' Permette a Excel di aggiornarsi
            Worksheets("FORMAZIONE").Activate
            Worksheets("FORMAZIONE").Rows(LastRowType - 1).Copy
            Worksheets("FORMAZIONE").Rows(LastRowType).PasteSpecial xlPasteAll
            Worksheets("TOT").Activate
            DoEvents ' Permette a Excel di aggiornarsi
            If LastRow >= LastRowType Then
                LastRow = LastRow + 1
            End If
            Worksheets("TOT").Cells(LastRowType, 2).Value = Worksheets("TOT").Cells(LastRow, 2).Value
            Worksheets("TOT").Cells(LastRowType, 26).Value = Worksheets("TOT").Cells(LastRow, 26).Value
            Worksheets("TOT").Cells(LastRowType, 33).Value = Worksheets("TOT").Cells(LastRow, 33).Value
            Worksheets("TOT").Cells(LastRowType, 3).Value = Worksheets("TOT").Cells(LastRow, 3).Value
            Worksheets("TOT").Cells(LastRowType, 34).Value = Worksheets("TOT").Cells(LastRow, 34).Value
            Worksheets("TOT").Cells(LastRowType, 53).Value = Worksheets("TOT").Cells(LastRow, 53).Value
            Worksheets("TOT").Cells(LastRowType, 27).Value = Worksheets("TOT").Cells(LastRow, 27).Value
            Worksheets("FORMAZIONE").Cells(LastRowType, 2).Value = Worksheets("FORMAZIONE").Cells(LastRow, 2).Value
            Worksheets("FORMAZIONE").Cells(LastRowType, 19).Value = Worksheets("FORMAZIONE").Cells(LastRow, 19).Value
        End If
        
        DoEvents ' Permette a Excel di aggiornarsi
        
        Application.DisplayAlerts = False
            Worksheets("TOT").Activate
            Dim cell As Range
            For Each cell In Worksheets("TOT").Range(Cells(LastRowType, 35), Cells(LastRowType, 50))
                cell.Value = Cells(LastRow, cell.Column).Value
            Next cell
            Worksheets("FORMAZIONE").Activate
            For Each cell In Worksheets("FORMAZIONE").Range(Cells(LastRowType, 20), Cells(LastRowType, 55))
                cell.Value = Worksheets("FORMAZIONE").Cells(LastRow, cell.Column).Value
            Next cell
            Worksheets("TOT").Activate
        Application.DisplayAlerts = True
        
        DoEvents ' Permette a Excel di aggiornarsi
        
        Worksheets("TOT").Rows(LastRow).Delete
        DoEvents ' Permette a Excel di aggiornarsi
        Worksheets("FORMAZIONE").Rows(LastRow).Delete
        DoEvents ' Permette a Excel di aggiornarsi
        
        Cells(4, 1).Value = 1
        LastRow = 5
        While Worksheets("TOT").Cells(LastRow, 1) <> "1"
            Worksheets("TOT").Cells(LastRow, 1) = LastRow - 3
            Worksheets("FORMAZIONE").Cells(LastRow, 1) = LastRow - 3
            LastRow = LastRow + 1
        Wend
        MsgBox "Dipendente aggiunto con successo.", vbInformation
        
        Worksheets("TOT").Range("A1").Activate
        Worksheets("FORMAZIONE").Activate
        Worksheets("FORMAZIONE").Range("A1").Activate
        Worksheets("TOT").Activate
        Worksheets("TOT").Protect Password:=Password
        Worksheets("FORMAZIONE").Protect Password:=Password
End Sub


Sub Delete_Worker()
    Dim Password
    Password = "Ej20082018*Excel"
    Worksheets("TOT").Unprotect Password:=Password
    Worksheets("FORMAZIONE").Unprotect Password:=Password
    Dim Answer As String
    Dim WorkerRow As Long
    Dim Confirmation As VbMsgBoxResult
    
    LoginForm.Show
    If Worksheets("Tabelle").Range("H3").Value = 0 Then Exit Sub
    
    ' Chiedi conferma per l'eliminazione
    Confirmation = MsgBox("Sei sicuro di voler eliminare il dipendente?", vbYesNo + vbDefaultButton2 + vbQuestion, "Conferma Eliminazione")
    If Confirmation = vbNo Then Exit Sub ' L'utente ha annullato
    
Start:
    ' Richiedi il numero del dipendente
    Answer = InputBox("Inserisci il numero del dipendente:")
    
    ' Controlla se l'utente ha premuto "Annulla"
    If Answer = "" Then
        Exit Sub
    End If

    ' Verifica che l'input sia un numero
    If Not IsNumeric(Answer) Then
        MsgBox "Per favore, inserisci un numero valido.", vbCritical
        GoTo Start
    End If
    
    ' Calcola la riga del dipendente
    WorkerRow = 3 + CLng(Answer) ' Converti il numero in Long
    
    ' Verifica se il dipendente esiste
    If Worksheets("TOT").Cells(WorkerRow + 4, 1).Value = "" Then
        MsgBox "Dipendente non esistente.", vbCritical
        GoTo Start
    End If
    
    Confirmation = MsgBox("Sei sicuro di voler eliminare " & Cells(WorkerRow, 2).Value & "?", vbYesNo + vbDefaultButton2 + vbQuestion, "Conferma Eliminazione")
    If Confirmation = vbNo Then Exit Sub ' L'utente ha annullato
    
    ' Eliminazione della riga
    Worksheets("TOT").Rows(WorkerRow).Delete
    DoEvents ' Permette a Excel di aggiornarsi
    Worksheets("FORMAZIONE").Rows(WorkerRow).Delete
    DoEvents ' Permette a Excel di aggiornarsi
    Worksheets("TOT").Cells(4, 1).Value = 1
    Worksheets("FORMAZIONE").Cells(4, 1).Value = 1
    WorkerRow = 5
    While Worksheets("TOT").Cells(WorkerRow, 1) <> "1"
        Worksheets("TOT").Cells(WorkerRow, 1) = WorkerRow - 3
        Worksheets("FORMAZIONE").Cells(WorkerRow, 1) = WorkerRow - 3
        WorkerRow = WorkerRow + 1
    Wend
    MsgBox "Dipendente eliminato con successo.", vbInformation
    DoEvents ' Permette a Excel di aggiornarsi
    
    Worksheets("TOT").Range("A1").Activate
    Worksheets("FORMAZIONE").Activate
    Worksheets("FORMAZIONE").Range("A1").Activate
    Worksheets("TOT").Activate
    
    Worksheets("TOT").Protect Password:=Password
    Worksheets("FORMAZIONE").Protect Password:=Password
End Sub


Sub Modify_worker()
    Dim Password
    Password = "Ej20082018*Excel"
    Worksheets("TOT").Unprotect Password:=Password
    Worksheets("FORMAZIONE").Unprotect Password:=Password
    Dim Answer As String
    Dim WorkerRow As Long
    Dim SelectedOption As String
    Dim LastRowType As Integer
    
    LoginForm.Show
    If Worksheets("Tabelle").Range("H3").Value = 0 Then Exit Sub
    
    Answer = InputBox("Inserisci il numero del dipendente:")
    
    ' Controlla se l'utente ha premuto "Annulla"
    If Answer = "" Then
        On Error GoTo 0
        Exit Sub
    End If

    ' Verifica che l'input sia un numero
    If Not IsNumeric(Answer) Then
        MsgBox "Per favore, inserisci un numero valido.", vbCritical
        Call Modify_worker
    End If
    
    ' Esempio: cerca il dipendente in una colonna del foglio
    WorkerRow = 3 + Answer
    
    ' Se il dipendente non esiste
    If Cells(WorkerRow + 4, 1).Value = "" Then
        MsgBox "Dipendente non esistente.", vbCritical
        On Error GoTo 0
        Exit Sub
    End If
    
    ' Mostra il form e ottieni l'opzione selezionata
    SelectedOption = Change_Worker.GetSelectedOption()
    If SelectedOption = "" Then Exit Sub ' L'utente ha annullato
    
    ' Modifica il dato selezionato
    If SelectedOption = "Nome" Then
        Answer = InputBox("Inserisci il nuovo nome per il dipendente " & WorkerRow - 3 & ":")
        Worksheets("TOT").Cells(WorkerRow, 2).Value = Answer
        Worksheets("TOT").Cells(WorkerRow, 26).Value = Answer
        Worksheets("TOT").Cells(WorkerRow, 33).Value = Answer
    ElseIf SelectedOption = "Nome_Cognome" Then
        Answer = InputBox("Inserisci il nuovo nome e cognome per il dipendente " & WorkerRow - 3 & ":")
        Worksheets("TOT").Cells(WorkerRow, 3).Value = Answer
        Worksheets("TOT").Cells(WorkerRow, 34).Value = Answer
        Worksheets("TOT").Cells(WorkerRow, 53).Value = Answer
        Worksheets("FORMAZIONE").Cells(WorkerRow, 2).Value = Answer
        Worksheets("FORMAZIONE").Cells(WorkerRow, 19).Value = Answer
    ElseIf SelectedOption = "Contratto" Then
        Answer = InputBox("Inserisci il contratto per il dipendente " & WorkerRow - 3 & ":")
        Worksheets("TOT").Cells(WorkerRow, 27).Value = Answer
    ElseIf SelectedOption = "Ruolo" Then
        SelectedOption = Change_Type.GetSelectedOption()
        If SelectedOption = "" Then Exit Sub ' L'utente ha annullato
        
        LastRowType = 4
        
        If SelectedOption = "Gel" Then
            While Cells(LastRowType, 2).Interior.Color <> RGB(255, 255, 255)
                LastRowType = LastRowType + 1
            Wend
            Worksheets("TOT").Rows(LastRowType).Insert
    DoEvents ' Permette a Excel di aggiornarsi
    Worksheets("FORMAZIONE").Activate
    Worksheets("FORMAZIONE").Rows(LastRowType).Insert
    DoEvents ' Permette a Excel di aggiornarsi
    Worksheets("TOT").Activate
    Worksheets("TOT").Rows(LastRowType - 1).Copy
    Worksheets("TOT").Rows(LastRowType).PasteSpecial xlPasteAll
    DoEvents ' Permette a Excel di aggiornarsi
    Worksheets("FORMAZIONE").Activate
    Worksheets("FORMAZIONE").Rows(LastRowType - 1).Copy
    Worksheets("FORMAZIONE").Rows(LastRowType).PasteSpecial xlPasteAll
    Worksheets("TOT").Activate
    DoEvents ' Permette a Excel di aggiornarsi
            If WorkerRow >= LastRowType Then
                WorkerRow = WorkerRow + 1
            End If
            Worksheets("TOT").Cells(LastRowType, 2).Value = Worksheets("TOT").Cells(WorkerRow, 2).Value
            Worksheets("TOT").Cells(LastRowType, 26).Value = Worksheets("TOT").Cells(WorkerRow, 26).Value
            Worksheets("TOT").Cells(LastRowType, 33).Value = Worksheets("TOT").Cells(WorkerRow, 33).Value
            Worksheets("TOT").Cells(LastRowType, 3).Value = Worksheets("TOT").Cells(WorkerRow, 3).Value
            Worksheets("TOT").Cells(LastRowType, 34).Value = Worksheets("TOT").Cells(WorkerRow, 34).Value
            Worksheets("TOT").Cells(LastRowType, 53).Value = Worksheets("TOT").Cells(WorkerRow, 53).Value
            Worksheets("TOT").Cells(LastRowType, 27).Value = Worksheets("TOT").Cells(WorkerRow, 27).Value
            Worksheets("FORMAZIONE").Cells(LastRowType, 2).Value = Worksheets("FORMAZIONE").Cells(WorkerRow, 2).Value
            Worksheets("FORMAZIONE").Cells(LastRowType, 19).Value = Worksheets("FORMAZIONE").Cells(WorkerRow, 19).Value
        ElseIf SelectedOption = "Front" Then
            While Cells(LastRowType, 2).Interior.Color <> RGB(221, 235, 247)
                LastRowType = LastRowType + 1
            Wend
            Worksheets("TOT").Rows(LastRowType).Insert
    DoEvents ' Permette a Excel di aggiornarsi
    Worksheets("FORMAZIONE").Activate
    Worksheets("FORMAZIONE").Rows(LastRowType).Insert
    DoEvents ' Permette a Excel di aggiornarsi
    Worksheets("TOT").Activate
    Worksheets("TOT").Rows(LastRowType - 1).Copy
    Worksheets("TOT").Rows(LastRowType).PasteSpecial xlPasteAll
    DoEvents ' Permette a Excel di aggiornarsi
    Worksheets("FORMAZIONE").Activate
    Worksheets("FORMAZIONE").Rows(LastRowType - 1).Copy
    Worksheets("FORMAZIONE").Rows(LastRowType).PasteSpecial xlPasteAll
    Worksheets("TOT").Activate
    DoEvents ' Permette a Excel di aggiornarsi
            If WorkerRow >= LastRowType Then
                WorkerRow = WorkerRow + 1
            End If
            Worksheets("TOT").Cells(LastRowType, 2).Value = Worksheets("TOT").Cells(WorkerRow, 2).Value
            Worksheets("TOT").Cells(LastRowType, 26).Value = Worksheets("TOT").Cells(WorkerRow, 26).Value
            Worksheets("TOT").Cells(LastRowType, 33).Value = Worksheets("TOT").Cells(WorkerRow, 33).Value
            Worksheets("TOT").Cells(LastRowType, 3).Value = Worksheets("TOT").Cells(WorkerRow, 3).Value
            Worksheets("TOT").Cells(LastRowType, 34).Value = Worksheets("TOT").Cells(WorkerRow, 34).Value
            Worksheets("TOT").Cells(LastRowType, 53).Value = Worksheets("TOT").Cells(WorkerRow, 53).Value
            Worksheets("TOT").Cells(LastRowType, 27).Value = Worksheets("TOT").Cells(WorkerRow, 27).Value
            Worksheets("FORMAZIONE").Cells(LastRowType, 2).Value = Worksheets("FORMAZIONE").Cells(WorkerRow, 2).Value
            Worksheets("FORMAZIONE").Cells(LastRowType, 19).Value = Worksheets("FORMAZIONE").Cells(WorkerRow, 19).Value
        ElseIf SelectedOption = "Tutto" Then
            While Cells(LastRowType, 2).Interior.Color <> RGB(252, 228, 214)
                LastRowType = LastRowType + 1
            Wend
            Worksheets("TOT").Rows(LastRowType).Insert
    DoEvents ' Permette a Excel di aggiornarsi
    Worksheets("FORMAZIONE").Activate
    Worksheets("FORMAZIONE").Rows(LastRowType).Insert
    DoEvents ' Permette a Excel di aggiornarsi
    Worksheets("TOT").Activate
    Worksheets("TOT").Rows(LastRowType - 1).Copy
    Worksheets("TOT").Rows(LastRowType).PasteSpecial xlPasteAll
    DoEvents ' Permette a Excel di aggiornarsi
    Worksheets("FORMAZIONE").Activate
    Worksheets("FORMAZIONE").Rows(LastRowType - 1).Copy
    Worksheets("FORMAZIONE").Rows(LastRowType).PasteSpecial xlPasteAll
    Worksheets("TOT").Activate
    DoEvents ' Permette a Excel di aggiornarsi
            If WorkerRow >= LastRowType Then
                WorkerRow = WorkerRow + 1
            End If
            Worksheets("TOT").Cells(LastRowType, 2).Value = Worksheets("TOT").Cells(WorkerRow, 2).Value
            Worksheets("TOT").Cells(LastRowType, 26).Value = Worksheets("TOT").Cells(WorkerRow, 26).Value
            Worksheets("TOT").Cells(LastRowType, 33).Value = Worksheets("TOT").Cells(WorkerRow, 33).Value
            Worksheets("TOT").Cells(LastRowType, 3).Value = Worksheets("TOT").Cells(WorkerRow, 3).Value
            Worksheets("TOT").Cells(LastRowType, 34).Value = Worksheets("TOT").Cells(WorkerRow, 34).Value
            Worksheets("TOT").Cells(LastRowType, 53).Value = Worksheets("TOT").Cells(WorkerRow, 53).Value
            Worksheets("TOT").Cells(LastRowType, 27).Value = Worksheets("TOT").Cells(WorkerRow, 27).Value
            Worksheets("FORMAZIONE").Cells(LastRowType, 2).Value = Worksheets("FORMAZIONE").Cells(WorkerRow, 2).Value
            Worksheets("FORMAZIONE").Cells(LastRowType, 19).Value = Worksheets("FORMAZIONE").Cells(WorkerRow, 19).Value
        ElseIf SelectedOption = "Cucina" Then
            LastRowType = 5
            While Cells(LastRowType, 1) <> "1"
                LastRowType = LastRowType + 1
            Wend
            Worksheets("TOT").Rows(LastRowType).Insert
    DoEvents ' Permette a Excel di aggiornarsi
    Worksheets("FORMAZIONE").Activate
    Worksheets("FORMAZIONE").Rows(LastRowType).Insert
    DoEvents ' Permette a Excel di aggiornarsi
    Worksheets("TOT").Activate
    Worksheets("TOT").Rows(LastRowType - 1).Copy
    Worksheets("TOT").Rows(LastRowType).PasteSpecial xlPasteAll
    DoEvents ' Permette a Excel di aggiornarsi
    Worksheets("FORMAZIONE").Activate
    Worksheets("FORMAZIONE").Rows(LastRowType - 1).Copy
    Worksheets("FORMAZIONE").Rows(LastRowType).PasteSpecial xlPasteAll
    Worksheets("TOT").Activate
    DoEvents ' Permette a Excel di aggiornarsi
            If WorkerRow >= LastRowType Then
                WorkerRow = WorkerRow + 1
            End If
            Worksheets("TOT").Cells(LastRowType, 2).Value = Worksheets("TOT").Cells(WorkerRow, 2).Value
            Worksheets("TOT").Cells(LastRowType, 26).Value = Worksheets("TOT").Cells(WorkerRow, 26).Value
            Worksheets("TOT").Cells(LastRowType, 33).Value = Worksheets("TOT").Cells(WorkerRow, 33).Value
            Worksheets("TOT").Cells(LastRowType, 3).Value = Worksheets("TOT").Cells(WorkerRow, 3).Value
            Worksheets("TOT").Cells(LastRowType, 34).Value = Worksheets("TOT").Cells(WorkerRow, 34).Value
            Worksheets("TOT").Cells(LastRowType, 53).Value = Worksheets("TOT").Cells(WorkerRow, 53).Value
            Worksheets("TOT").Cells(LastRowType, 27).Value = Worksheets("TOT").Cells(WorkerRow, 27).Value
            Worksheets("FORMAZIONE").Cells(LastRowType, 2).Value = Worksheets("FORMAZIONE").Cells(WorkerRow, 2).Value
            Worksheets("FORMAZIONE").Cells(LastRowType, 19).Value = Worksheets("FORMAZIONE").Cells(WorkerRow, 19).Value
        End If
        
        DoEvents ' Permette a Excel di aggiornarsi
        
        Application.DisplayAlerts = False
            Worksheets("TOT").Activate
            Dim cell As Range
            For Each cell In Worksheets("TOT").Range(Cells(LastRowType, 35), Cells(LastRowType, 50))
                cell.Activate
                Cells(WorkerRow, cell.Column).Activate
                cell.Value = Cells(WorkerRow, cell.Column).Value
                DoEvents ' Permette a Excel di aggiornarsi
            Next cell
            Worksheets("FORMAZIONE").Activate
            For Each cell In Worksheets("FORMAZIONE").Range(Cells(LastRowType, 20), Cells(LastRowType, 55))
                cell.Activate
                Worksheets("FORMAZIONE").Cells(WorkerRow, cell.Column).Activate
                cell.Value = Worksheets("FORMAZIONE").Cells(WorkerRow, cell.Column).Value
                DoEvents ' Permette a Excel di aggiornarsi
            Next cell
            Worksheets("TOT").Activate
        Application.DisplayAlerts = True

        
        Worksheets("TOT").Rows(WorkerRow).Delete
        DoEvents ' Permette a Excel di aggiornarsi
        Worksheets("FORMAZIONE").Rows(WorkerRow).Delete
        DoEvents ' Permette a Excel di aggiornarsi
        Cells(4, 1).Value = 1
        WorkerRow = 5
        While Worksheets("TOT").Cells(WorkerRow, 1) <> "1"
            Worksheets("TOT").Cells(WorkerRow, 1) = WorkerRow - 3
            Worksheets("FORMAZIONE").Cells(WorkerRow, 1) = WorkerRow - 3
            WorkerRow = WorkerRow + 1
        Wend
    End If

    MsgBox "Dipendente modificato con successo.", vbInformation
    
    Worksheets("TOT").Range("A1").Activate
    Worksheets("FORMAZIONE").Activate
    Worksheets("FORMAZIONE").Range("A1").Activate
    Worksheets("TOT").Activate
    Worksheets("TOT").Protect Password:=Password
    Worksheets("FORMAZIONE").Protect Password:=Password
End Sub

Sub PrintRange()
    Dim LastRow As Integer
    LastRow = 4
    While Cells(LastRow, 1) <> ""
        LastRow = LastRow + 1
    Wend
    LastRow = LastRow + 2
    ' Variabili per l'input dell'utente
    Dim scelta As Integer
    Dim rangeDaStampare As Range
    
    ' Mostra una finestra di dialogo per scegliere tra due opzioni
    scelta = MsgBox("Scegli quale intervallo stampare:" & vbCrLf & _
                    "Si: Con orari" & vbCrLf & _
                    "No: Senza orari", vbYesNoCancel + vbQuestion, "Scegli intervallo")
    
    ' Controllo la scelta dell'utente
    If scelta = vbYes Then
        Set rangeDaStampare = Range(Cells(1, 3), Cells(LastRow, 17))
        rangeDaStampare.PrintOut
    ElseIf scelta = vbNo Then
        Set rangeDaStampare = Range(Cells(1, 53), Cells(LastRow, 67))
        rangeDaStampare.PrintOut
    Else
        MsgBox "Operazione annullata."
    End If
    
End Sub